---
// components import
import SecondaryLayout from '../../layouts/SecondaryLayout.astro';
import Image from 'astro/components/Image.astro';

// utility import
import { getCollection } from 'astro:content';

// styles import
import '../../styles/secondary-page.css';

export async function getStaticPaths() {
	const blogEntries = await getCollection('blog');
	return blogEntries.map((entry) => ({
		params: { slug: entry.slug },
		props: { entry },
	}));
}

const { entry } = Astro.props;
const { Content } = await entry.render();
---

<SecondaryLayout title={entry.data.title}>
	<div class="secondary-page-content">
		<main>
			<article class="container">
				<h1 class="blog-title">{entry.data.title} - {entry.data.subtitle}</h1>
				<p>
					<a href={`../blog/${entry.data.author}`} class="author"
						>{entry.data.author}</a
					> &middot; {
						new Date(entry.data.publishedDate).toLocaleDateString('es-ES', {
							year: 'numeric',
							month: 'long',
							day: 'numeric',
						})
					}
				</p>

				<ul class="categories margin-extra">
					{
						entry.data.categories.map((category) => (
							<li>
								<a href={`/blog/${category}`} class="category">
									{category}
								</a>
							</li>
						))
					}
				</ul>

				<Image
					src={entry.data.image.src}
					alt={entry.data.image.alt}
					aria-hidden="true"
					width="500"
					height="300"
					decoding="async"
					loading="eager"
					class="blog-image"
				/>

				<Content />
			</article>
		</main>
	</div>
</SecondaryLayout>
